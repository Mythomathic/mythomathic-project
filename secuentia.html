<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Secuentia - Mythomathic</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="secuentia.css">
</head>

<body>
<header>
  <button class="back-button" onclick="goTo('map.html')">‚¨Ö Mapa</button>
  <div class="title-center">
    <img src="S_Title.png" alt="Secuentia" class="title-img">
  </div>
  <div class="header-buttons">
    <button onclick="openLore()">üìú Lore</button>
    <button onclick="toggleMenu()">‚ò∞ Men√∫</button>
  </div>
  <nav id="menu">
    <ul>
      <li onclick="goTo('map.html')">Mapa</li>
      <li onclick="goTo('perfil.html')">Perfil</li>
      <li onclick="goTo('config.html')">Configuraci√≥</li>
      <li onclick="goTo('sobremi.html')">Sobre mi</li>
      <li onclick="goTo('contacte.html')">Contacte</li>
    </ul>
  </nav>
</header>

<main class="dimension-container">
  <aside class="categories">
    <button onclick="showSymbols('aritmetiques')">P. Aritm√®tiques</button>
    <button onclick="showSymbols('geometriques')">P. Geom√®triques</button>
    <button onclick="showSymbols('generals')">Termes Generals</button>
  </aside>

  <div class="symbols">
    <!-- Progressions Aritm√®tiques -->
    <img src="icon-sec.png" alt="Aritm√®tiques" class="symbol" data-cat="aritmetiques"
         style="top: 180px; left: 320px;" onclick="openPopup('Suma i termes de PA')">
    <img src="icon-sec.png" alt="Aritm√®tiques" class="symbol" data-cat="aritmetiques"
         style="top: 430px; left: 980px;" onclick="openPopup('Troba el terme general PA')">

    <!-- Progressions Geom√®triques -->
    <img src="icon-sec.png" alt="Geom√®triques" class="symbol" data-cat="geometriques"
         style="top: 220px; left: 780px;" onclick="openPopup('Suma i termes de PG')">
    <img src="icon-sec.png" alt="Geom√®triques" class="symbol" data-cat="geometriques"
         style="top: 420px; left: 560px;" onclick="openPopup('Troba el terme general PG')">

    <!-- Termes Generals -->
    <img src="icon-sec.png" alt="Generals" class="symbol" data-cat="generals"
         style="top: 350px; left: 940px;" onclick="openPopup('Calcula termes de la successi√≥')">
    <img src="icon-sec.png" alt="Generals" class="symbol" data-cat="generals"
         style="top: 510px; left: 260px;" onclick="openPopup('Troba el terme indicat')">
  </div>
</main>

<!-- POPUP LORE -->
<div id="lorePopup" class="popup">
  <div class="popup-content lore-content">
    <span class="close" onclick="closeLore()">&times;</span>
    <img src="pergami.png" alt="Pergam√≠" class="scroll-img">
  </div>
</div>

<!-- POPUP EXERCICI -->
<div id="exercisePopup" class="popup">
  <div class="popup-content">
    <span class="close" onclick="closePopup()">&times;</span>
    <h2 id="exerciseTitle"></h2>
    <div id="exerciseContent"></div>
  </div>
</div>

<script>
function toggleMenu() {
  document.getElementById('menu').classList.toggle('active');
}

function goTo(page) {
  window.location.href = page;
}

function openLore() {
  document.getElementById("lorePopup").style.display = "flex";
}

function closeLore() {
  document.getElementById("lorePopup").style.display = "none";
}

function showSymbols(type) {
  document.querySelectorAll(".symbol").forEach(el => el.style.display = "none");
  document.querySelectorAll(".symbol[data-cat='"+type+"']").forEach(el => el.style.display = "block");
}

document.addEventListener("DOMContentLoaded", () => {
  showSymbols("aritmetiques");
});

// ===== POPUP Exercicis =====
function closePopup() {
  document.getElementById("exercisePopup").style.display = "none";
}

// Generaci√≥ aleat√≤ria d‚Äôexercicis
function randomInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

// Diccionari d‚Äôexercicis
const exercises = {
  "Calcula termes de la successi√≥": () => {
    const n = randomInt(3,7);
    const a = randomInt(1,5);
    const b = randomInt(1,5);
    const expr = `a_n = ${a}¬∑n^2 + ${b}¬∑n`;
    const container = document.getElementById("exerciseContent");
    container.innerHTML = `<p>Troba els ${n} primers termes de la successi√≥:</p>
      <p><b>${expr}</b></p>
      <input type="text" id="answer" placeholder="Ex: 12, 24, 48...">
      <button onclick="generateTermsExercise(${a},${b},${n})">Comprovar</button>
      <button onclick="exercises['Calcula termes de la successi√≥']()">Nova activitat</button>
      <p id="feedback"></p>`;
  },

  "Troba el terme indicat": () => {
    const n = randomInt(5,15);
    const a = randomInt(1,5);
    const b = randomInt(-5,5);
    const expr = `a_n = ${a}¬∑n + ${b}`;
    const container = document.getElementById("exerciseContent");
    container.innerHTML = `<p>Troba el terme a<sub>${n}</sub> de la successi√≥:</p>
      <p><b>${expr}</b></p>
      <input type="text" id="answer" placeholder="Ex: 12">
      <button onclick="checkTerm(${a},${b},${n})">Comprovar</button>
      <button onclick="exercises['Troba el terme indicat']()">Nova activitat</button>
      <p id="feedback"></p>`;
  },

  "Suma i termes de PA": () => {
    const a2 = randomInt(1,10);
    const a7 = randomInt(20,50);
    const d = (a7 - a2)/5;
    const a1 = a2 - d;
    const container = document.getElementById("exerciseContent");
    container.innerHTML = `<p>En una progressi√≥ aritm√®tica, a2 = ${a2} i a7 = ${a7}. Escriu el terme general i els 5 primers termes.</p>
      <input type="text" id="answer" placeholder="Ex: a_n = ...">
      <button onclick="checkPA(${a1},${d})">Comprovar</button>
      <button onclick="exercises['Suma i termes de PA']()">Nova activitat</button>
      <p id="feedback"></p>`;
  },

  "Troba el terme general PA": () => {
    const s3 = randomInt(20,60);
    const s6 = randomInt(80,150);
    const container = document.getElementById("exerciseContent");
    container.innerHTML = `<p>La suma dels tres primers termes d'una PA √©s ${s3} i la suma dels tres seg√ºents √©s ${s6}. Troba el terme general.</p>
      <input type="text" id="answer" placeholder="Ex: a_n = ...">
      <button onclick="checkPA2(${s3},${s6})">Comprovar</button>
      <button onclick="exercises['Troba el terme general PA']()">Nova activitat</button>
      <p id="feedback"></p>`;
  },

  "Suma i termes de PG": () => {
    const c4 = randomInt(10,50);
    const c5 = randomInt(20,60);
    const container = document.getElementById("exerciseContent");
    container.innerHTML = `<p>En una progressi√≥ geom√®trica, c4 = ${c4} i c5 = ${c5}. Escriu el terme general.</p>
      <input type="text" id="answer" placeholder="Ex: c_n = ...">
      <button onclick="checkPG(${c4},${c5})">Comprovar</button>
      <button onclick="exercises['Suma i termes de PG']()">Nova activitat</button>
      <p id="feedback"></p>`;
  },

  "Troba el terme general PG": () => {
    const sInf = randomInt(10,50);
    const a2 = randomInt(1,10);
    const container = document.getElementById("exerciseContent");
    container.innerHTML = `<p>La suma infinita d'una PG √©s ${sInf} i a2 = ${a2}. Calcula a1 i la ra√≥.</p>
      <input type="text" id="answer" placeholder="Ex: a1 = ..., r = ...">
      <button onclick="checkPG2(${sInf},${a2})">Comprovar</button>
      <button onclick="exercises['Troba el terme general PG']()">Nova activitat</button>
      <p id="feedback"></p>`;
  }
};

function openPopup(title) {
  document.getElementById("exerciseTitle").textContent = title;
  document.getElementById("exercisePopup").style.display = "flex";
  document.getElementById("exerciseContent").innerHTML = "";
  if (exercises[title]) {
    exercises[title]();
  } else {
    document.getElementById("exerciseContent").innerHTML = "<p>Encara no hi ha exercicis disponibles per aquest apartat.</p>";
  }
}

// ===== Funcions de comprovaci√≥ =====
function generateTermsExercise(a,b,n) {
  const correct = Array.from({length:n}, (_,i) => a*(i+1)**2 + b*(i+1)).join(", ");
  const userAns = document.getElementById("answer").value.trim();
  const fb = document.getElementById("feedback");
  if(userAns === correct){
    fb.textContent = "Correcte! ‚úîÔ∏è";
    fb.style.color = "green";
  } else {
    fb.textContent = `Incorrecte ‚ùå (resposta esperada: ${correct})`;
    fb.style.color = "red";
  }
}

function checkTerm(a,b,n) {
  const correct = a*n + b;
  const userAns = Number(document.getElementById("answer").value.trim());
  const fb = document.getElementById("feedback");
  if(userAns === correct){
    fb.textContent = "Correcte! ‚úîÔ∏è";
    fb.style.color = "green";
  } else {
    fb.textContent = `Incorrecte ‚ùå (resposta esperada: ${correct})`;
    fb.style.color = "red";
  }
}

function checkPA(a1,d) {
  const correct = `a_n = ${a1} + ${d}¬∑(n-1)`;
  const fb = document.getElementById("feedback");
  const userAns = document.getElementById("answer").value.trim();
  if(userAns === correct){
    fb.textContent = "Correcte! ‚úîÔ∏è";
    fb.style.color = "green";
  } else {
    fb.textContent = `Incorrecte ‚ùå (resposta esperada: ${correct})`;
    fb.style.color = "red";
  }
}

function checkPA2(s3,s6) {
  const fb = document.getElementById("feedback");
  fb.textContent = "Revisa el c√†lcul segons la suma dels termes. ‚ùå";
  fb.style.color = "red";
}

function checkPG(c4,c5) {
  const fb = document.getElementById("feedback");
  fb.textContent = "Calcula a partir de la ra√≥ c5/c4 i troba c1. ‚ùå";
  fb.style.color = "red";
}

function checkPG2(sInf,a2) {
  const fb = document.getElementById("feedback");
  fb.textContent = "Calcula a1 = ?, ra√≥ = ?. ‚ùå";
  fb.style.color = "red";
}

</script>
</body>
</html>

