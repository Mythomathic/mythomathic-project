<!DOCTYPE html> 
<html lang="ca"> 
    <head> 
        <meta charset="UTF-8"> 
        <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
        <title>Derivalia - Mythomathic</title> 
        <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet"> 
        <link rel="stylesheet" href="derivalia.css"> 
    </head> 
<body> 
    <header> 
<button class="back-button" onclick="goTo('map.html')">â¬… Mapa</button> 
<div class="title-center"> 
<img src="D_Title.png" alt="Derivalia" class="title-img"> 
</div> 
<div class="header-buttons"> 
    <button onclick="openLore()">ğŸ“œ Lore</button> 
    <button onclick="toggleMenu()">â˜° MenÃº</button> 
</div> 
<nav id="menu"> 
    <ul> <li onclick="goTo('map.html')">Mapa</li> 
        <li onclick="goTo('perfil.html')">Perfil</li> 
        <li onclick="goTo('config.html')">ConfiguraciÃ³</li> 
        <li onclick="goTo('sobremi.html')">Sobre mi</li> 
        <li onclick="goTo('contacte.html')">Contacte</li> 
    </ul> 
</nav> 
</header> 

<main class="dimension-container">
  <aside class="categories">
    <button onclick="showSymbols('basics')">Derivades bÃ siques</button>
    <button onclick="showSymbols('exp')">Exponencials i logarÃ­tmiques</button>
    <button onclick="showSymbols('trig')">TrigonomÃ¨triques</button>
    <button onclick="showSymbols('cadena')">Regla de la cadena</button>
  </aside>

  <div class="symbols">
    <img src="icon-deriv.png" class="symbol" data-cat="basics" style="top:200px; left:400px;" onclick="openPopup('Derivades bÃ siques')">
    <img src="icon-deriv.png" class="symbol" data-cat="exp" style="top:300px; left:700px;" onclick="openPopup('Derivades exponencials i logarÃ­tmiques')">
    <img src="icon-deriv.png" class="symbol" data-cat="trig" style="top:420px; left:600px;" onclick="openPopup('Derivades trigonomÃ¨triques')">
    <img src="icon-deriv.png" class="symbol" data-cat="cadena" style="top:600px; left:800px;" onclick="openPopup('Regla de la cadena')">
  </div>
</main>

<div id="exercisePopup" class="popup">
  <div class="popup-content">
    <span class="close" onclick="closePopup()">&times;</span>
    <h2 id="exerciseTitle"></h2>
    <div id="exerciseContent"></div>
    <p id="feedback"></p>
  </div>
</div>

<script>
function toggleMenu(){}
function goTo(p){window.location.href=p;}
function showSymbols(cat){
  document.querySelectorAll('.symbol').forEach(s=>s.style.display='none');
  document.querySelectorAll(`.symbol[data-cat="${cat}"]`).forEach(s=>s.style.display='block');
}
document.addEventListener('DOMContentLoaded',()=>showSymbols('basics'));
function closePopup(){document.getElementById('exercisePopup').style.display='none';}
function randomChoice(a){return a[Math.floor(Math.random()*a.length)];}

// ===== EXERCICIS =====
const exercises = {

  "Derivades bÃ siques":()=> {
    const exemples=[
      {text:"f(x)=xÂ³+2xÂ²âˆ’5x+1", ans:"f'(x)=3xÂ²+4xâˆ’5"},
      {text:"f(x)=4xâµâˆ’3xÂ²+7", ans:"f'(x)=20xâ´âˆ’6x"},
      {text:"f(x)=âˆšx+2x", ans:"f'(x)=1/(2âˆšx)+2"},
      {text:"f(x)=1/xÂ²+5x", ans:"f'(x)=âˆ’2/xÂ³+5"}
    ];
    renderExercise(randomChoice(exemples),"Derivades bÃ siques");
  },

  "Derivades exponencials i logarÃ­tmiques":()=> {
    const exemples=[
      {text:"f(x)=eË£", ans:"f'(x)=eË£"},
      {text:"f(x)=3eË£+2", ans:"f'(x)=3eË£"},
      {text:"f(x)=e^(2x)", ans:"f'(x)=2e^(2x)"},
      {text:"f(x)=lnx", ans:"f'(x)=1/x"},
      {text:"f(x)=2ln(5x)", ans:"f'(x)=2/x"},
      {text:"f(x)=ln(3xÂ²+1)", ans:"f'(x)=(6x)/(3xÂ²+1)"}
    ];
    renderExercise(randomChoice(exemples),"Derivades exponencials i logarÃ­tmiques");
  },

  "Derivades trigonomÃ¨triques":()=> {
    const exemples=[
      {text:"f(x)=âˆ’5sinx", ans:"f'(x)=âˆ’5cosx"},
      {text:"f(x)=sinx+6", ans:"f'(x)=cosx"},
      {text:"f(x)=cosx/10", ans:"f'(x)=âˆ’sinx/10"},
      {text:"f(x)=6tanx", ans:"f'(x)=6secÂ²x"},
      {text:"f(x)=arcsinx", ans:"f'(x)=1/âˆš(1âˆ’xÂ²)"},
      {text:"f(x)=4arccosx", ans:"f'(x)=âˆ’4/âˆš(1âˆ’xÂ²)"},
      {text:"f(x)=arctanx/2", ans:"f'(x)=1/(2(1+xÂ²))"},
      {text:"f(x)=sin(xÂ²)âˆ’x", ans:"f'(x)=2xcos(xÂ²)âˆ’1"},
      {text:"f(x)=cos3x", ans:"f'(x)=âˆ’3sin3x"},
      {text:"f(x)=arctan(3xÂ²+8x)", ans:"f'(x)=(6x+8)/(1+(3xÂ²+8x)Â²)"}
    ];
    renderExercise(randomChoice(exemples),"Derivades trigonomÃ¨triques");
  },

  "Regla de la cadena":()=> {
    const exemples=[
      {text:"f(x)=sin(3x)", ans:"f'(x)=3cos(3x)"},
      {text:"f(x)=cos(2xÂ²)", ans:"f'(x)=âˆ’4xsin(2xÂ²)"},
      {text:"f(x)=e^(xÂ²+1)", ans:"f'(x)=2xe^(xÂ²+1)"},
      {text:"f(x)=ln(5xÂ²+3)", ans:"f'(x)=(10x)/(5xÂ²+3)"},
      {text:"f(x)=tan(4x)", ans:"f'(x)=4secÂ²(4x)"}
    ];
    renderExercise(randomChoice(exemples),"Regla de la cadena");
  }
};

// ===== FUNCIONS AUXILIARS =====
function renderExercise(ex,section){
  document.getElementById("exerciseContent").innerHTML=`
    <p>Calcula la derivada de:</p>
    <b>${ex.text}</b><br><br>
    <input id="answer1" placeholder="Ex: f'(x)=...">
    <button id="checkBtn">Comprovar</button>
    <button id="newBtn">Nova activitat</button>
  `;
  document.getElementById("feedback").innerHTML="";

  document.getElementById("checkBtn").onclick = function(){
    checkTextAnswers([ex.ans]);
  }
  document.getElementById("newBtn").onclick = function(){
    exercises[section]();
  }
}

function openPopup(title){
  document.getElementById("exerciseTitle").textContent=title;
  document.getElementById("exercisePopup").style.display="flex";
  exercises[title]();
}

function checkTextAnswers(expected){
  const user=document.getElementById("answer1").value.trim().toLowerCase().replace(/\s+/g,'');
  const valid=expected.map(e=>e.toLowerCase().replace(/\s+/g,''));
  const fb=document.getElementById("feedback");
  fb.innerHTML= valid.includes(user) ? "âœ… Correcte!" : `âŒ Incorrecte (resposta esperada: ${expected[0]})`;
}
</script>

</body>
</html>
