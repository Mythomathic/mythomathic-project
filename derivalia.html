<!DOCTYPE html> 
<html lang="ca"> 
    <head> 
        <meta charset="UTF-8"> 
        <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
        <title>Derivalia - Mythomathic</title> 
        <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet"> 
        <link rel="stylesheet" href="derivalia.css"> 
    </head> 
<body> 
    <header> 
<button class="back-button" onclick="goTo('map.html')">⬅ Mapa</button> 
<div class="title-center"> 
<img src="D_Title.png" alt="Derivalia" class="title-img"> 
</div> 
<div class="header-buttons"> 
    <button onclick="openLore()">📜 Lore</button> 
    <button onclick="toggleMenu()">☰ Menú</button> 
</div> 
<nav id="menu"> 
    <ul> <li onclick="goTo('map.html')">Mapa</li> 
        <li onclick="goTo('perfil.html')">Perfil</li> 
        <li onclick="goTo('config.html')">Configuració</li> 
        <li onclick="goTo('sobremi.html')">Sobre mi</li> 
        <li onclick="goTo('contacte.html')">Contacte</li> 
    </ul> 
</nav> 
</header> 

<main class="dimension-container">
  <aside class="categories">
    <button onclick="showSymbols('basics')">Derivades bàsiques</button>
    <button onclick="showSymbols('exp')">Exponencials i logarítmiques</button>
    <button onclick="showSymbols('trig')">Trigonomètriques</button>
    <button onclick="showSymbols('cadena')">Regla de la cadena</button>
  </aside>

  <div class="symbols">
    <img src="icon-deriv.png" class="symbol" data-cat="basics" style="top:200px; left:400px;" onclick="openPopup('Derivades bàsiques')">
    <img src="icon-deriv.png" class="symbol" data-cat="exp" style="top:300px; left:700px;" onclick="openPopup('Derivades exponencials i logarítmiques')">
    <img src="icon-deriv.png" class="symbol" data-cat="trig" style="top:420px; left:600px;" onclick="openPopup('Derivades trigonomètriques')">
    <img src="icon-deriv.png" class="symbol" data-cat="cadena" style="top:600px; left:800px;" onclick="openPopup('Regla de la cadena')">
  </div>
</main>

<div id="exercisePopup" class="popup">
  <div class="popup-content">
    <span class="close" onclick="closePopup()">&times;</span>
    <h2 id="exerciseTitle"></h2>
    <div id="exerciseContent"></div>
    <p id="feedback"></p>
  </div>
</div>

<script>
function toggleMenu(){}
function goTo(p){window.location.href=p;}
function showSymbols(cat){
  document.querySelectorAll('.symbol').forEach(s=>s.style.display='none');
  document.querySelectorAll(`.symbol[data-cat="${cat}"]`).forEach(s=>s.style.display='block');
}
document.addEventListener('DOMContentLoaded',()=>showSymbols('basics'));
function closePopup(){document.getElementById('exercisePopup').style.display='none';}
function randomChoice(a){return a[Math.floor(Math.random()*a.length)];}

// ===== EXERCICIS =====
const exercises = {

  "Derivades bàsiques":()=> {
    const exemples=[
      {text:"f(x)=x³+2x²−5x+1", ans:"f'(x)=3x²+4x−5"},
      {text:"f(x)=4x⁵−3x²+7", ans:"f'(x)=20x⁴−6x"},
      {text:"f(x)=√x+2x", ans:"f'(x)=1/(2√x)+2"},
      {text:"f(x)=1/x²+5x", ans:"f'(x)=−2/x³+5"}
    ];
    renderExercise(randomChoice(exemples),"Derivades bàsiques");
  },

  "Derivades exponencials i logarítmiques":()=> {
    const exemples=[
      {text:"f(x)=eˣ", ans:"f'(x)=eˣ"},
      {text:"f(x)=3eˣ+2", ans:"f'(x)=3eˣ"},
      {text:"f(x)=e^(2x)", ans:"f'(x)=2e^(2x)"},
      {text:"f(x)=lnx", ans:"f'(x)=1/x"},
      {text:"f(x)=2ln(5x)", ans:"f'(x)=2/x"},
      {text:"f(x)=ln(3x²+1)", ans:"f'(x)=(6x)/(3x²+1)"}
    ];
    renderExercise(randomChoice(exemples),"Derivades exponencials i logarítmiques");
  },

  "Derivades trigonomètriques":()=> {
    const exemples=[
      {text:"f(x)=−5sinx", ans:"f'(x)=−5cosx"},
      {text:"f(x)=sinx+6", ans:"f'(x)=cosx"},
      {text:"f(x)=cosx/10", ans:"f'(x)=−sinx/10"},
      {text:"f(x)=6tanx", ans:"f'(x)=6sec²x"},
      {text:"f(x)=arcsinx", ans:"f'(x)=1/√(1−x²)"},
      {text:"f(x)=4arccosx", ans:"f'(x)=−4/√(1−x²)"},
      {text:"f(x)=arctanx/2", ans:"f'(x)=1/(2(1+x²))"},
      {text:"f(x)=sin(x²)−x", ans:"f'(x)=2xcos(x²)−1"},
      {text:"f(x)=cos3x", ans:"f'(x)=−3sin3x"},
      {text:"f(x)=arctan(3x²+8x)", ans:"f'(x)=(6x+8)/(1+(3x²+8x)²)"}
    ];
    renderExercise(randomChoice(exemples),"Derivades trigonomètriques");
  },

  "Regla de la cadena":()=> {
    const exemples=[
      {text:"f(x)=sin(3x)", ans:"f'(x)=3cos(3x)"},
      {text:"f(x)=cos(2x²)", ans:"f'(x)=−4xsin(2x²)"},
      {text:"f(x)=e^(x²+1)", ans:"f'(x)=2xe^(x²+1)"},
      {text:"f(x)=ln(5x²+3)", ans:"f'(x)=(10x)/(5x²+3)"},
      {text:"f(x)=tan(4x)", ans:"f'(x)=4sec²(4x)"}
    ];
    renderExercise(randomChoice(exemples),"Regla de la cadena");
  }
};

// ===== FUNCIONS AUXILIARS =====
function renderExercise(ex,section){
  document.getElementById("exerciseContent").innerHTML=`
    <p>Calcula la derivada de:</p>
    <b>${ex.text}</b><br><br>
    <input id="answer1" placeholder="Ex: f'(x)=...">
    <button id="checkBtn">Comprovar</button>
    <button id="newBtn">Nova activitat</button>
  `;
  document.getElementById("feedback").innerHTML="";

  document.getElementById("checkBtn").onclick = function(){
    checkTextAnswers([ex.ans]);
  }
  document.getElementById("newBtn").onclick = function(){
    exercises[section]();
  }
}

function openPopup(title){
  document.getElementById("exerciseTitle").textContent=title;
  document.getElementById("exercisePopup").style.display="flex";
  exercises[title]();
}

function checkTextAnswers(expected){
  const user=document.getElementById("answer1").value.trim().toLowerCase().replace(/\s+/g,'');
  const valid=expected.map(e=>e.toLowerCase().replace(/\s+/g,''));
  const fb=document.getElementById("feedback");
  fb.innerHTML= valid.includes(user) ? "✅ Correcte!" : `❌ Incorrecte (resposta esperada: ${expected[0]})`;
}
</script>

</body>
</html>
